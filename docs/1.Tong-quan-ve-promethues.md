## Tổng quan về prometheus

### Mục lục

[1. Tổng quan](#tongquan)<br>
[2. Khái niệm](#khainiem)<br>
[3. Kiến trúc](#kientruc)<br>

<a name="tongquan"></a>
## 1. Tổng quan

- `PUSH` và `FULL` trong giám sát

+ `PUSH` metric có nghĩa là khi đó trách nhiệm thu thập dữ liệu (scaping) từ các dịch vụ cần giám sát về máy chủ giám sát phụ thuộc vào các agent trên các máy client, mỗi khi có thay đổi dữ liệu các agent sẽ chủ động đẩy đến máy chủ giám sát

-> Agent có trách nhiệm đẩy metric và cập nhật sự thay đổi của metric về server giám sát.

+ `FULL` metric có nghĩa là lúc này trách nhiệm thu thập dữ liệu (scaping) từ các dịch vụ cần giám sát thuộc về máy chủ giám sát.

-> Máy chủ giám sát có trách nhiệm chủ động thu thập metric về mình.

- `Prometheus` là một hệ thống giám sát và cảnh báo. Là một dự án mã nguồn mở được phát triển bởi SoundCloud vào năm 2012 và được ấp ủ bở cộng đồng Cloud Native Computing Foundation. Prometheus có khả năng thu thập các metrics từ các targets được cấu hình theo các khoảng thời gian nhất định.

- Prometheus là một công cụ monitor server mã nguồn mở với cơ sở dữ liệu theo thời gian thực (An opensource  time series database).

- Time series database là những database được lưu trữ theo các mốc thời gian. Mỗi dữ liệu luôn được gắn tag với một mốc thời gian nên có thể xem lại dữ liệu theo các mốc thời gian trước đó.

<a name="khainiem"></a>
## 2. Khái niệm

- `Client Libraries`: Metrics không thể tự xuất hiện từ các ứng dụng cần phải có một thành phần để biểu thị ở một dạng có nghĩa, lúc này cần đến client libraries.

Client libraries hỗ trợ rất nhiều các ngôn ngữ, prometheus cung cấp client libraries cho Go, Python, Java/JVM và Ruby. Ngoài ra còn hỗ trợ các loại thư viện bên thứ 3 như C#/.NET, NodeJS, Haskell, Erlang và Rust.

- `Exporters:` Exporter là một chương trình với mục đích thu thập, phân tích và chuyển đổi các dữ liệu chưa đúng chuẩn prometheus sang đúng chuẩn prometheus và hỗ trợ việc phơi các thông tin metrics ra web service api.


- `Scrapes:` Service discovery và relabeling cung cấp các targets cần được giám sát. Prometheus cần phải có các metrics để giám sát, prometheus sẽ gửi một request HTTP được gọi là scrape, phản hồi nhận được từ scape được phân tích và lưu trữ tại storage. Một số metrics hữu ích cũng được thêm vào, khoảng cách của một lần scrape phụ thuộc vào cấu hình trên prometheus.

- `Storage`: Prometheus lưu trữ dữ liệu tại local bên trong một custom db.

- `Metrics names and labels`: Mỗi time series được xác định duy nhất bởi tên metrics và một cặp key-value, còn được gọi là label.

**Metric name:** Chỉ định các thông số của hệ thống, ví dụ như http_requests_total - Tổng số request HTTP đã nhận.

**Labels:** Bất kỳ sự kết hợp label nào.

<a name="kientruc"></a>
## 3. Kiến trúc

![](../images/tong-quan-promethues/hoat-dong.png)

![](../images/tong-quan-promethues/kien-truc.png)































